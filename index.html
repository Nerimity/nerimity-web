<!DOCTYPE html>
<html lang="en">
  <head>
    <script>
      let crashShown = false;
      const IGNORE_ERROR_PATTERNS = ["ResizeObserver loop completed with undelivered notifications", "ResizeObserver loop limit exceeded", ];
      const shouldIgnoreError = (message) => {
        if (!message) return true;
        return IGNORE_ERROR_PATTERNS.some((pattern) => String(message).includes(pattern));
      };
      const showCrashPopup = (message) => {
        if (crashShown) return;
        crashShown = true;
        const div = document.createElement("div");
        div.id = "crash-reporter-popup";
        div.style.cssText = `
          position: fixed;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          background: black;
          color: #fab1a0;
          padding: 20px;
          border-radius: 12px;
          z-index: 999999;
          box-shadow: 0 10px 30px rgba(0,0,0,0.5);
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          max-width: 400px;
          width: 90%;
          border-left: 5px solid #ff7675;
          border: solid 1px rgba(255,255,255,0.4);
        `;
        div.innerHTML = `
          
			<div style="font-weight: bold; font-size: 18px; margin-bottom: 10px; color: #ff7675;">
            ⚠️ Nerimity Has Crashed
          </div>
			<div style="font-size: 14px; color: #dfe6e9; line-height: 1.4; margin-bottom: 20px; word-break: break-word;">
            ${message}
            
				<div style="margin-top: 10px; opacity: 0.8;">
              See the console for more details.
              
					<code style="color: #ff7675; font-size: 12px;">
                (CTRL + SHIFT + I)
              </code>
				</div>
			</div>
			<div style="display: flex; gap: 10px;">
				<button
              id="crash-reload"
              style="
                flex: 1;
                background: #ff7675;
                color: white;
                border: none;
                padding: 10px;
                border-radius: 6px;
                cursor: pointer;
                font-weight: bold;
              "
            >
              Reload Page
            </button>
				<button
              id="crash-close"
              style="
                flex: 1;
                background: #1a1a1a;
                color: white;
                border: none;
                padding: 10px;
                border-radius: 6px;
                cursor: pointer;
              "
            >
              Dismiss
            </button>
			</div>
        `;
        document.body.appendChild(div);
        document.getElementById("crash-reload").onclick = () => {
          window.location.reload();
        };
        document.getElementById("crash-close").onclick = () => {
          div.remove();
        };
      };
      window.addEventListener("error", (event) => {
        const msg = event.error?.message || event.message;
        if (shouldIgnoreError(msg)) return;
        showCrashPopup(msg);
      });
      window.addEventListener("unhandledrejection", (event) => {
        const msg = event.reason?.message || event.reason || "Unknown Promise Rejection";
        if (shouldIgnoreError(msg)) return;
        showCrashPopup(`Promise Error: ${msg}`);
      });
    </script>
    <meta charset="utf-8" />
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, interactive-widget=resizes-content" />
    <meta name="title" content="Nerimity" />
    <meta name="theme-color" content="#000000" />
    <meta property="og:title" content="Nerimity" />
    <meta name="og:description" content="Nerimity is an open source, modern and sleek chat app made for everyone with features such as servers, customization, and more." />
    <meta name="description" content="Nerimity is an open source, modern and sleek chat app made for everyone with features such as servers, customization, and more." />
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="icon" type="image/png" href="/favicon.ico" />
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script src="/src/index.tsx" type="module"></script>
  </body>
</html>
